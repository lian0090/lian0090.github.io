<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>
        
        Internal Post Management in Crayon | Aram Kocharyan
        
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/lib/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/lib/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/lib/bootstrap/css/docs.css" rel="stylesheet">
    <link href="/lib/google-code-prettify/prettify.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="/lib/html5shiv.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png">
    <link rel="shortcut icon" href="/assets/ico/favicon.png">

</head>

<body data-spy="scroll" data-target=".bs-docs-sidebar">
<!-- Navbar
    ================================================== -->
<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="brand" href="/">Aram Kocharyan</a>

            <div class="nav-collapse collapse">
                <ul class="nav">
                    <li class="">
                        <a href="/projects">Projects</a>
                    </li>
                    <li class="">
                        <a href="/projects/crayon.html">Crayon</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="container main-container">
    <article class="single">
    <div class="meta">
        <h1 class="title">Internal Post Management in Crayon</h1>

        <span class="date">26 Sep 2012</span>
    </div>

    <div id="post">
        Crayon's internal post management determines when the rest of the system should kick in.

When you save/edit a page, Crayon searches through the content and keeps a reference to the post in the database if it contains any Crayon tags. When you save/edit a comment, the same process takes place.

When you load a page, Crayon goes through all the posts requested (for a single page, this is usually just a single post) and only checks those known to contain Crayon posts. For each of these, Crayon captures any tags used and keeps them in internal PHP memory.

When the page or comment content is requested by Wordpress, Crayon steps in, highlights the code in the tags it captured earlier and replaces the original tags in the content.

This means that <strong>only those pages that contain Crayons are ever checked for Crayons</strong>, meaning much more efficient than looking through every single post on the blog for Crayon tags!

In Crayon 1.12, I've added a feature in the settings page to display all the posts that contain Crayon tags. It will also list all the posts which have Crayon tags in their comments, even if the post itself doesn't contain any. This is crucial to ensure Crayon kicks in and highlights the code in those comments.

<a href="http://localsite.com/ak/wp-content/uploads/2012/09/Screen-Shot-2012-09-26-at-6.40.57-PM.png"><img class="aligncenter size-full wp-image-1022" title="Screen Shot 2012-09-26 at 6.40.57 PM" src="http://localsite.com/ak/wp-content/uploads/2012/09/Screen-Shot-2012-09-26-at-6.40.57-PM.png" alt="" width="307" height="49" /></a>

<a href="http://localsite.com/ak/wp-content/uploads/2012/09/Screen-Shot-2012-09-26-at-6.41.03-PM.png"><img class="aligncenter size-full wp-image-1023" title="Screen Shot 2012-09-26 at 6.41.03 PM" src="http://localsite.com/ak/wp-content/uploads/2012/09/Screen-Shot-2012-09-26-at-6.41.03-PM.png" alt="" width="502" height="283" /></a>

As an added safety measure, when you refresh the settings page, Crayon will manually go through all the posts in your site and update the list of those containing Crayons in the database. So if anything funky happens that somehow messes up this list, refreshing the settings page should sort it out.

    </div>
</article>

</div>

<!-- Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <p>Aram Kocharyan, <span class="date">2015</span>.</p>

        <p>Built with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> + <a
                href="http://twitter.github.io/bootstrap/" target="_blank">Bootstrap</a>. Hosted at <a
                href="http://pages.github.com/">GitHub Pages.</a></p>
    </div>
</footer>

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="/lib/jquery.js"></script>
<script src="/lib/bootstrap/js/bootstrap.min.js"></script>

<script src="/lib/holder.js"></script>
<script src="/lib/google-code-prettify/prettify.js"></script>

<script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-38031779-1']);
    _gaq.push(['_trackPageview']);

    (function () {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
    })();

</script>

</body>
</html>